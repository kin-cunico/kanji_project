(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))m(o);new MutationObserver(o=>{for(const d of o)if(d.type==="childList")for(const f of d.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&m(f)}).observe(document,{childList:!0,subtree:!0});function u(o){const d={};return o.integrity&&(d.integrity=o.integrity),o.referrerPolicy&&(d.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?d.credentials="include":o.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function m(o){if(o.ep)return;o.ep=!0;const d=u(o);fetch(o.href,d)}})();function T(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var k={exports:{}};/**
 * vivus - JavaScript library to make drawing animation on SVG
 * @version v0.4.6
 * @link https://github.com/maxwellito/vivus
 * @license MIT
 */var x;function I(){return x||(x=1,function(l,c){(function(){function u(t){if(typeof t>"u")throw new Error('Pathformer [constructor]: "element" parameter is required');if(t.constructor===String&&(t=document.getElementById(t),!t))throw new Error('Pathformer [constructor]: "element" parameter is not related to an existing ID');if(t instanceof window.SVGElement||t instanceof window.SVGGElement||/^svg$/i.test(t.nodeName))this.el=t;else throw new Error('Pathformer [constructor]: "element" parameter must be a string or a SVGelement');this.scan(t)}u.prototype.TYPES=["line","ellipse","circle","polygon","polyline","rect"],u.prototype.ATTR_WATCH=["cx","cy","points","r","rx","ry","x","x1","x2","y","y1","y2"],u.prototype.scan=function(t){for(var n,e,r,i,s=t.querySelectorAll(this.TYPES.join(",")),h=0;h<s.length;h++)e=s[h],n=this[e.tagName.toLowerCase()+"ToPath"],r=n(this.parseAttr(e.attributes)),i=this.pathMaker(e,r),e.parentNode.replaceChild(i,e)},u.prototype.lineToPath=function(t){var n={},e=t.x1||0,r=t.y1||0,i=t.x2||0,s=t.y2||0;return n.d="M"+e+","+r+"L"+i+","+s,n},u.prototype.rectToPath=function(t){var n={},e=parseFloat(t.x)||0,r=parseFloat(t.y)||0,i=parseFloat(t.width)||0,s=parseFloat(t.height)||0;if(t.rx||t.ry){var h=parseInt(t.rx,10)||-1,p=parseInt(t.ry,10)||-1;h=Math.min(Math.max(h<0?p:h,0),i/2),p=Math.min(Math.max(p<0?h:p,0),s/2),n.d="M "+(e+h)+","+r+" L "+(e+i-h)+","+r+" A "+h+","+p+",0,0,1,"+(e+i)+","+(r+p)+" L "+(e+i)+","+(r+s-p)+" A "+h+","+p+",0,0,1,"+(e+i-h)+","+(r+s)+" L "+(e+h)+","+(r+s)+" A "+h+","+p+",0,0,1,"+e+","+(r+s-p)+" L "+e+","+(r+p)+" A "+h+","+p+",0,0,1,"+(e+h)+","+r}else n.d="M"+e+" "+r+" L"+(e+i)+" "+r+" L"+(e+i)+" "+(r+s)+" L"+e+" "+(r+s)+" Z";return n},u.prototype.polylineToPath=function(t){var n={},e=t.points.trim().split(" "),r,i;if(t.points.indexOf(",")===-1){var s=[];for(r=0;r<e.length;r+=2)s.push(e[r]+","+e[r+1]);e=s}for(i="M"+e[0],r=1;r<e.length;r++)e[r].indexOf(",")!==-1&&(i+="L"+e[r]);return n.d=i,n},u.prototype.polygonToPath=function(t){var n=u.prototype.polylineToPath(t);return n.d+="Z",n},u.prototype.ellipseToPath=function(t){var n={},e=parseFloat(t.rx)||0,r=parseFloat(t.ry)||0,i=parseFloat(t.cx)||0,s=parseFloat(t.cy)||0,h=i-e,p=s,g=parseFloat(i)+parseFloat(e),w=s;return n.d="M"+h+","+p+"A"+e+","+r+" 0,1,1 "+g+","+w+"A"+e+","+r+" 0,1,1 "+h+","+w,n},u.prototype.circleToPath=function(t){var n={},e=parseFloat(t.r)||0,r=parseFloat(t.cx)||0,i=parseFloat(t.cy)||0,s=r-e,h=i,p=parseFloat(r)+parseFloat(e),g=i;return n.d="M"+s+","+h+"A"+e+","+e+" 0,1,1 "+p+","+g+"A"+e+","+e+" 0,1,1 "+s+","+g,n},u.prototype.pathMaker=function(t,n){var e,r,i=document.createElementNS("http://www.w3.org/2000/svg","path");for(e=0;e<t.attributes.length;e++)r=t.attributes[e],this.ATTR_WATCH.indexOf(r.name)===-1&&i.setAttribute(r.name,r.value);for(e in n)i.setAttribute(e,n[e]);return i},u.prototype.parseAttr=function(t){for(var n,e={},r=0;r<t.length;r++){if(n=t[r],this.ATTR_WATCH.indexOf(n.name)!==-1&&n.value.indexOf("%")!==-1)throw new Error("Pathformer [parseAttr]: a SVG shape got values in percentage. This cannot be transformed into 'path' tags. Please use 'viewBox'.");e[n.name]=n.value}return e};var m,o,d,f;function a(t,n,e){m(),this.isReady=!1,this.setElement(t,n),this.setOptions(n),this.setCallback(e),this.isReady&&this.init()}a.LINEAR=function(t){return t},a.EASE=function(t){return-Math.cos(t*Math.PI)/2+.5},a.EASE_OUT=function(t){return 1-Math.pow(1-t,3)},a.EASE_IN=function(t){return Math.pow(t,3)},a.EASE_OUT_BOUNCE=function(t){var n=-Math.cos(t*(.5*Math.PI))+1,e=Math.pow(n,1.5),r=Math.pow(1-t,2),i=-Math.abs(Math.cos(e*(2.5*Math.PI)))+1;return 1-r+i*r},a.prototype.setElement=function(t,n){var e,r;if(typeof t>"u")throw new Error('Vivus [constructor]: "element" parameter is required');if(t.constructor===String&&(t=document.getElementById(t),!t))throw new Error('Vivus [constructor]: "element" parameter is not related to an existing ID');if(this.parentEl=t,n&&n.file){r=this,e=function(){var s=document.createElement("div");s.innerHTML=this.responseText;var h=s.querySelector("svg");if(!h)throw new Error("Vivus [load]: Cannot find the SVG in the loaded file : "+n.file);r.el=h,r.el.setAttribute("width","100%"),r.el.setAttribute("height","100%"),r.parentEl.appendChild(r.el),r.isReady=!0,r.init(),r=null};var i=new window.XMLHttpRequest;i.addEventListener("load",e),i.open("GET",n.file),i.send();return}switch(t.constructor){case window.SVGSVGElement:case window.SVGElement:case window.SVGGElement:this.el=t,this.isReady=!0;break;case window.HTMLObjectElement:r=this,e=function(s){if(!r.isReady){if(r.el=t.contentDocument&&t.contentDocument.querySelector("svg"),!r.el&&s)throw new Error("Vivus [constructor]: object loaded does not contain any SVG");r.el&&(t.getAttribute("built-by-vivus")&&(r.parentEl.insertBefore(r.el,t),r.parentEl.removeChild(t),r.el.setAttribute("width","100%"),r.el.setAttribute("height","100%")),r.isReady=!0,r.init(),r=null)}},e()||t.addEventListener("load",e);break;default:throw new Error('Vivus [constructor]: "element" parameter is not valid (or miss the "file" attribute)')}},a.prototype.setOptions=function(t){var n=["delayed","sync","async","nsync","oneByOne","scenario","scenario-sync"],e=["inViewport","manual","autostart"];if(t!==void 0&&t.constructor!==Object)throw new Error('Vivus [constructor]: "options" parameter must be an object');if(t=t||{},t.type&&n.indexOf(t.type)===-1)throw new Error("Vivus [constructor]: "+t.type+" is not an existing animation `type`");if(this.type=t.type||n[0],t.start&&e.indexOf(t.start)===-1)throw new Error("Vivus [constructor]: "+t.start+" is not an existing `start` option");if(this.start=t.start||e[0],this.isIE=window.navigator.userAgent.indexOf("MSIE")!==-1||window.navigator.userAgent.indexOf("Trident/")!==-1||window.navigator.userAgent.indexOf("Edge/")!==-1,this.duration=f(t.duration,120),this.delay=f(t.delay,null),this.dashGap=f(t.dashGap,1),this.forceRender=t.hasOwnProperty("forceRender")?!!t.forceRender:this.isIE,this.reverseStack=!!t.reverseStack,this.selfDestroy=!!t.selfDestroy,this.onReady=t.onReady,this.map=[],this.frameLength=this.currentFrame=this.delayUnit=this.speed=this.handle=null,this.ignoreInvisible=t.hasOwnProperty("ignoreInvisible")?!!t.ignoreInvisible:!1,this.animTimingFunction=t.animTimingFunction||a.LINEAR,this.pathTimingFunction=t.pathTimingFunction||a.LINEAR,this.delay>=this.duration)throw new Error("Vivus [constructor]: delay must be shorter than duration")},a.prototype.setCallback=function(t){if(t&&t.constructor!==Function)throw new Error('Vivus [constructor]: "callback" parameter must be a function');this.callback=t||function(){}},a.prototype.mapping=function(){var t,n,e,r,i,s,h,p,g,w;for(p=s=h=0,n=this.el.querySelectorAll("path"),w=!1,t=0;t<n.length;t++)if(e=n[t],!this.isInvisible(e)){if(i={el:e,length:0,startAt:0,duration:0,isResizeSensitive:!1},e.getAttribute("vector-effect")==="non-scaling-stroke"){var L=e.getBoundingClientRect(),j=e.getBBox();g=Math.max(L.width/j.width,L.height/j.height),i.isResizeSensitive=!0,w=!0}else g=1;if(i.length=Math.ceil(e.getTotalLength()*g),isNaN(i.length)){window.console&&console.warn&&console.warn("Vivus [mapping]: cannot retrieve a path element length",e);continue}this.map.push(i),e.style.strokeDasharray=i.length+" "+(i.length+this.dashGap*2),e.style.strokeDashoffset=i.length+this.dashGap,i.length+=this.dashGap,s+=i.length,this.renderPath(t)}for(w&&console.warn("Vivus: this SVG contains non-scaling-strokes. You should call instance.recalc() when the SVG is resized or you will encounter unwanted behaviour. See https://github.com/maxwellito/vivus#non-scaling for more info."),s=s===0?1:s,this.delay=this.delay===null?this.duration/3:this.delay,this.delayUnit=this.delay/(n.length>1?n.length-1:1),this.reverseStack&&this.map.reverse(),t=0;t<this.map.length;t++){switch(i=this.map[t],this.type){case"delayed":i.startAt=this.delayUnit*t,i.duration=this.duration-this.delay;break;case"oneByOne":i.startAt=h/s*this.duration,i.duration=i.length/s*this.duration;break;case"sync":case"async":case"nsync":i.startAt=0,i.duration=this.duration;break;case"scenario-sync":e=i.el,r=this.parseAttr(e),i.startAt=p+(f(r["data-delay"],this.delayUnit)||0),i.duration=f(r["data-duration"],this.duration),p=r["data-async"]!==void 0?i.startAt:i.startAt+i.duration,this.frameLength=Math.max(this.frameLength,i.startAt+i.duration);break;case"scenario":e=i.el,r=this.parseAttr(e),i.startAt=f(r["data-start"],this.delayUnit)||0,i.duration=f(r["data-duration"],this.duration),this.frameLength=Math.max(this.frameLength,i.startAt+i.duration);break}h+=i.length,this.frameLength=this.frameLength||this.duration}},a.prototype.recalc=function(){this.mustRecalcScale||(this.mustRecalcScale=o((function(){this.performLineRecalc()}).bind(this)))},a.prototype.performLineRecalc=function(){for(var t,n,e,r,i,s=0;s<this.map.length;s++)t=this.map[s],t.isResizeSensitive&&(n=t.el,e=n.getBoundingClientRect(),r=n.getBBox(),i=Math.max(e.width/r.width,e.height/r.height),t.length=Math.ceil(n.getTotalLength()*i),n.style.strokeDasharray=t.length+" "+(t.length+this.dashGap*2));this.trace(),this.mustRecalcScale=null},a.prototype.draw=function(){var t=this;if(this.currentFrame+=this.speed,this.currentFrame<=0)this.stop(),this.reset();else if(this.currentFrame>=this.frameLength)this.stop(),this.currentFrame=this.frameLength,this.trace(),this.selfDestroy&&this.destroy();else{this.trace(),this.handle=o(function(){t.draw()});return}this.callback(this),this.instanceCallback&&(this.instanceCallback(this),this.instanceCallback=null)},a.prototype.trace=function(){var t,n,e,r;for(r=this.animTimingFunction(this.currentFrame/this.frameLength)*this.frameLength,t=0;t<this.map.length;t++)e=this.map[t],n=(r-e.startAt)/e.duration,n=this.pathTimingFunction(Math.max(0,Math.min(1,n))),e.progress!==n&&(e.progress=n,e.el.style.strokeDashoffset=Math.floor(e.length*(1-n)),this.renderPath(t))},a.prototype.renderPath=function(t){if(this.forceRender&&this.map&&this.map[t]){var n=this.map[t],e=n.el.cloneNode(!0);n.el.parentNode.replaceChild(e,n.el),n.el=e}},a.prototype.init=function(){this.frameLength=0,this.currentFrame=0,this.map=[],new u(this.el),this.mapping(),this.starter(),this.onReady&&this.onReady(this)},a.prototype.starter=function(){switch(this.start){case"manual":return;case"autostart":this.play();break;case"inViewport":var t=this,n=function(){t.isInViewport(t.parentEl,1)&&(t.play(),window.removeEventListener("scroll",n))};window.addEventListener("scroll",n),n();break}},a.prototype.getStatus=function(){return this.currentFrame===0?"start":this.currentFrame===this.frameLength?"end":"progress"},a.prototype.reset=function(){return this.setFrameProgress(0)},a.prototype.finish=function(){return this.setFrameProgress(1)},a.prototype.setFrameProgress=function(t){return t=Math.min(1,Math.max(0,t)),this.currentFrame=Math.round(this.frameLength*t),this.trace(),this},a.prototype.play=function(t,n){if(this.instanceCallback=null,t&&typeof t=="function")this.instanceCallback=t,t=null;else if(t&&typeof t!="number")throw new Error("Vivus [play]: invalid speed");return n&&typeof n=="function"&&!this.instanceCallback&&(this.instanceCallback=n),this.speed=t||1,this.handle||this.draw(),this},a.prototype.stop=function(){return this.handle&&(d(this.handle),this.handle=null),this},a.prototype.destroy=function(){this.stop();var t,n;for(t=0;t<this.map.length;t++)n=this.map[t],n.el.style.strokeDashoffset=null,n.el.style.strokeDasharray=null,this.renderPath(t)},a.prototype.isInvisible=function(t){var n,e=t.getAttribute("data-ignore");return e!==null?e!=="false":this.ignoreInvisible?(n=t.getBoundingClientRect(),!n.width&&!n.height):!1},a.prototype.parseAttr=function(t){var n,e={};if(t&&t.attributes)for(var r=0;r<t.attributes.length;r++)n=t.attributes[r],e[n.name]=n.value;return e},a.prototype.isInViewport=function(t,n){var e=this.scrollY(),r=e+this.getViewportH(),i=t.getBoundingClientRect(),s=i.height,h=e+i.top,p=h+s;return n=n||0,h+s*n<=r&&p>=e},a.prototype.getViewportH=function(){var t=this.docElem.clientHeight,n=window.innerHeight;return t<n?n:t},a.prototype.scrollY=function(){return window.pageYOffset||this.docElem.scrollTop},m=function(){a.prototype.docElem||(a.prototype.docElem=window.document.documentElement,o=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),d=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t)}}())},f=function(t,n){var e=parseInt(t,10);return e>=0?e:n},l.exports=a})()}(k)),k.exports}var R=I();const F=T(R);class V{constructor(c,u){this.kanji=c,this.kanjiData=u}render(){const c=document.createElement("div");c.className="flashcard";const u=document.createElement("h1");u.className="kanji-character",u.textContent=this.kanji,c.appendChild(u);const m=document.createElement("strong");m.className="kanji-level",m.textContent=this.kanjiData.level||"No level specified",c.appendChild(m);const o=document.createElement("div");o.className="kanji-animation",o.id=`animation-${this.kanji}`,c.appendChild(o);const d=document.createElement("p");d.className="kanji-meaning",d.textContent=this.kanjiData.meaning||"Meaning not available",c.appendChild(d);const f=document.createElement("div");f.className="kanji-readings",f.innerHTML=`
            <p><strong>On'yomi:</strong> ${this.kanjiData.readings.onyomi.join(", ")}</p>
            <p><strong>Kun'yomi:</strong> ${this.kanjiData.readings.kunyomi.join(", ")}</p>
        `,c.appendChild(f);const a=document.createElement("ul");if(a.className="kanji-examples",this.kanjiData.phraseExamples&&this.kanjiData.phraseExamples.length>0)this.kanjiData.phraseExamples.forEach(t=>{const n=document.createElement("li");n.textContent=t,a.appendChild(n)});else{const t=document.createElement("li");t.textContent="No examples available",a.appendChild(t)}return c.appendChild(a),c}loadStrokeAnimation(c){const u=this.kanjiData.svg;if(!u){console.error(`No SVG file found for kanji "${this.kanji}"`),document.getElementById(c).innerHTML=`<p style="color: red;">Error: SVG not found for "${this.kanji}"</p>`;return}const m=`kanji_project/assets/svg/${u}`;fetch(m).then(o=>{if(!o.ok)throw new Error(`SVG for kanji "${this.kanji}" not found`);return o.text()}).then(o=>{const d=document.getElementById(c);d.innerHTML=o;const f=d.querySelector("svg"),a=Array.from(f.querySelectorAll("path")),t=Array.from(f.querySelectorAll("text"));new F(f,{type:"oneByOne",duration:a.length*70,animTimingFunction:F.LINEAR,onProgress:n=>{this.updateStrokeNumbers(n,a,t)}})}).catch(o=>{console.error("Error fetching SVG:",o);const d=document.getElementById(c);d&&(d.innerHTML=`<p style="color: red;">${o.message}</p>`)})}}function P(l){return Math.floor(Math.random()*l)}let b={},y=[],v=P(50);async function O(){try{const l=await fetch("data/kanji.json");if(!l.ok)throw new Error("Failed to load kanji.json");b=await l.json(),y=Object.keys(b)}catch(l){console.error("Error loading kanji data:",l)}}function E(){const l=document.getElementById("app");l.innerHTML="";const c=y[v],u=b[c],m=new V(c,u);l.appendChild(m.render()),m.loadStrokeAnimation(`animation-${c}`)}function M(){v=(v+1)%y.length,E()}function S(){v=(v-1+y.length)%y.length,E()}function C(){E()}function B(l){let c;switch(l.type){case"click":l.target.id==="next-btn"?c="forward":l.target.id==="prev-btn"?c="back":l.target.id==="replay-btn"&&(c="select");break;case"keydown":switch(l.key){case"ArrowRight":c="forward";break;case"ArrowLeft":c="back";break;case"Enter":case"Return":c="select";break}break;default:return}switch(c){case"forward":M();break;case"back":S();break;case"select":C();break}}function N(){const l=document.getElementById("pop-up"),c=document.getElementById("kanji-list");c.innerHTML="",y.forEach((u,m)=>{const o=document.createElement("li");o.textContent=u,o.addEventListener("click",()=>{v=m,E(),A()}),c.appendChild(o)}),l.classList.remove("hidden"),l.setAttribute("aria-hidden","false")}function A(){const l=document.getElementById("pop-up");l.classList.add("hidden"),l.setAttribute("aria-hidden","true")}async function D(){if(await O(),y.length===0){console.error("Kanji list is empty. Check kanji.json.");return}E(),document.getElementById("next-btn").addEventListener("click",M),document.getElementById("prev-btn").addEventListener("click",S),document.getElementById("replay-btn").addEventListener("click",C),document.getElementById("choose-btn").addEventListener("click",N),document.getElementById("close-popup").addEventListener("click",A),document.getElementById("pop-up").addEventListener("click",l=>{l.target.id==="pop-up"&&A()}),document.addEventListener("keydown",B)}document.addEventListener("DOMContentLoaded",D);
